[tox]
envlist = py38, py39

[testenv:py{38,39}]

setenv =
    # example env variables
    HOME_DIR = {toxinidir}
    REWARD_WINDOW_IN_SECONDS = 7200
    AWS_BATCH_JOB_ARRAY_INDEX = 0
    WORKER_COUNT = 1

    TRAIN_BUCKET = train_bucket_test
    FIREHOSE_BUCKET = firehose_bucket_test

    S3_KEY = temp_s3_key
    AWS_BATCH_JOB_ATTEMPT = 1

    TEST_CASES_DIR = {toxinidir}/test_cases

    TEST_CASE_INGEST_JSON = ingest.json
    TEST_INGEST_EVERY_N_SECONDS = 5

    MERGE_TEST_DATA_RELATIVE_DIR = data/merge

    TEST_SINGLE_MODEL_MERGE_INITIAL_BATCH_JSON = single_model_merge_initial_batch.json
    TEST_SINGLE_MODEL_MERGE_INITIAL_BATCH_AND_ADDITIONAL_REWARDS_BATCH_JSON = single_model_merge_initial_batch_and_additional_rewards_batch.json
    TEST_SINGLE_MODEL_MERGE_ONLY_ADDITIONAL_REWARDS_BATCH_JSON = single_model_merge_only_additional_rewards_batch.json

    TEST_MULTIPLE_MODELS_MERGE_INITIAL_BATCH_JSON = multiple_models_merge_initial_batch.json
    TEST_MULTIPLE_MODELS_MERGE_INITIAL_BATCH_AND_ADDITIONAL_REWARDS_BATCH_JSON = multiple_models_merge_initial_batch_and_additional_rewards_batch.json
    TEST_MULTIPLE_MODELS_MERGE_ONLY_ADDITIONAL_REWARDS_BATCH_JSON = multiple_models_merge_only_additional_rewards_batch.json

    TEST__MERGE_MANY_RECORDS_GROUP_1_JSON = _merge_many_records_group_1.json
    TEST__MERGE_MANY_RECORDS_GROUP_2_JSON = _merge_many_records_group_2.json
    TEST__MERGE_MANY_RECORDS_GROUP_3_JSON = _merge_many_records_group_3.json
    TEST__MERGE_MANY_RECORDS_GROUP_4_JSON = _merge_many_records_group_4.json
    TEST__MERGE_MANY_RECORDS_GROUP_5_JSON = _merge_many_records_group_5.json
    TEST__MERGE_MANY_RECORDS_GROUP_6_JSON = _merge_many_records_group_6.json
    TEST__MERGE_MANY_RECORDS_GROUP_7_JSON = _merge_many_records_group_7.json
    TEST__MERGE_MANY_RECORDS_GROUP_8_JSON = _merge_many_records_group_8.json
    TEST__MERGE_MANY_RECORDS_GROUP_9_JSON = _merge_many_records_group_9.json
    TEST__MERGE_MANY_RECORDS_GROUP_10_JSON = _merge_many_records_group_10.json
    TEST__MERGE_MANY_RECORDS_GROUP_11_JSON = _merge_many_records_group_11.json
    TEST__MERGE_MANY_RECORDS_GROUP_12_JSON = _merge_many_records_group_12.json
    TEST__MERGE_MANY_RECORDS_GROUP_13_JSON = _merge_many_records_group_13.json

    TEST__MERGE_SINGLE_RECORD_GROUPS_1_JSON = _merge_single_record_groups_1.json
    TEST__MERGE_SINGLE_RECORD_GROUPS_2_JSON = _merge_single_record_groups_2.json
    TEST__MERGE_SINGLE_RECORD_GROUPS_3_JSON = _merge_single_record_groups_3.json


commands =
           pip3 install --upgrade pip
           pip3 install -r testrequirements.txt
           {envbindir}/pytest -v --capture=tee-sys --ignore=local_test --ignore=tools
